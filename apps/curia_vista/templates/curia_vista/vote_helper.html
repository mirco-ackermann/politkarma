<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script type="text/javascript"
            src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="/static/image-picker/image-picker.min.js"></script>
    <script type="text/javascript" src="/static/jquery-multiselect/jquery.multiselect.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/static/image-picker/image-picker.css">
    <link rel="stylesheet" type="text/css" href="/static/jquery-multiselect/jquery.multiselect.css">
    <link rel="stylesheet" type="text/css" href="/static/css/politkarma.css">
    <link rel="stylesheet" type="text/css"
          href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
    <title>Politkarma Vote Helper 3000</title>
</head>
<body>

<h1>Politkarma</h1>
<form method="get">
    <div class="filter-box">
        <h3>Datum</h3>
        von
        <input type="date" name="startdate" id="startdate" value="{{ startdate }}"/>
        bis
        <input type="date" name="enddate" id="enddate" value="{{ enddate }}"/>
    </div>
    <div class="filter-box">
        <h3>Kanton</h3>
        <select multiple="multiple" name="cantons" id="canton">
            {% for canton in cantons %}
                <option value="{{ canton.id }}">{{ canton.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="filter-box">
        <h3>Organisationen</h3>
        <select multiple="multiple" id="organization" name="organizations" class="image-picker show-html">
            {% for organization in organizations %}
                <option data-img-src="{{ organization.logo_location }}"
                        value="{{ organization.id }}">{{ organization.name }}</option>
            {% endfor %}
        </select>
    </div>
    <button class="analyze-button" type="submit">Analyze Karma!</button>
</form>

<h3>Resultate</h3>
<table style="width:100%;">
    <tr>
        <th>Rang</th>
        <th>Name</th>
        <th>Partei</th>
        <th>Karma Score</th>
        <th>History</th>
    </tr>
    {% for result in ranking %}
        <tr>
            <td>{{ result.rank }}</td>
            <td>{{ result.name }}</td>
            <td>{{ result.party }}</td>
            <td>{{ result.score }}</td>
            <td>
                <div id="chart1"/>
            </td>
        </tr>
    {% endfor %}
</table>

<script type="text/javascript">
    $("#startdate").datepicker({
        dateFormat: $.datepicker.ISO_8601
    });
    $("#enddate").datepicker({
        dateFormat: $.datepicker.ISO_8601
    });
    $("#canton").multiselect({
        header: "Kanton(e) ausw√§hlen"
    });
    $("#organization").imagepicker({
        hide_select: true,
        show_label: true
    });

    // based on https://jsfiddle.net/api/post/library/pure/
    google.charts.load('current', {packages: ['corechart', 'line']});
    google.charts.setOnLoadCallback(drawBasic);

    function drawBasic() {
        var data = new google.visualization.DataTable();
        data.addColumn('number', 'Tag');
        data.addColumn('number', 'Gesammeltes Karma');

        data.addRows([
            [0, 0], [1, 10], [2, 23], [3, 17], [4, 18], [5, 9],
            [6, 11], [7, 27], [8, 33], [9, 40], [10, 32], [11, 35],
            [12, 30], [13, 40], [14, 42], [15, 47], [16, 44], [17, 48],
            [18, 52], [19, 54], [20, 42], [21, 55], [22, 56], [23, 57]
        ]);

        var options = {
            hAxis: {
                title: 'Zeit'
            },
            vAxis: {
                title: 'Karma'
            }
        };
        var chart1 = new google.visualization.LineChart(document.getElementById('chart1'));
        chart1.draw(data, options);
    }
</script>

</body>
</html>